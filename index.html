<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi User Visit Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-purple-50 to-pink-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-purple-600 mb-2">ğŸ‘¥ Multi User Visit Simulator</h1>
            <p class="text-gray-600">Simulasi kunjungan dari berbagai user berbeda ke website target</p>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Kolom Kiri -->
            <div class="space-y-4">
                <!-- Input URL -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ğŸŒ URL Website Target</label>
                    <input 
                        type="url" 
                        id="urlInput" 
                        placeholder="https://example.com"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                        value="https://example.com"
                    >
                </div>

                <!-- Input Jumlah Visitor -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ğŸ‘¤ Jumlah Virtual Visitor</label>
                    <input 
                        type="number" 
                        id="visitorCount" 
                        placeholder="10"
                        min="1"
                        max="100"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                        value="10"
                    >
                </div>

                <!-- Input Interval -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">â±ï¸ Interval Antar Visitor (detik)</label>
                    <input 
                        type="number" 
                        id="intervalInput" 
                        placeholder="2"
                        min="1"
                        step="0.5"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                        value="2"
                    >
                </div>

                <!-- Random Delay -->
                <div>
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" id="randomDelay" class="w-5 h-5 text-purple-600" checked>
                        <span class="text-sm font-semibold text-gray-700">ğŸ² Random Delay (lebih natural)</span>
                    </label>
                    <p class="text-xs text-gray-500 mt-1 ml-7">Menambahkan variasi waktu acak antar kunjungan</p>
                </div>

                <!-- Randomize User Agent -->
                <div>
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" id="randomUA" class="w-5 h-5 text-purple-600" checked>
                        <span class="text-sm font-semibold text-gray-700">ğŸ”€ Randomize User Agent</span>
                    </label>
                    <p class="text-xs text-gray-500 mt-1 ml-7">Simulasi berbagai browser dan device</p>
                </div>

                <!-- Show Preview -->
                <div>
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" id="showPreview" class="w-5 h-5 text-purple-600">
                        <span class="text-sm font-semibold text-gray-700">ğŸ‘ï¸ Tampilkan Preview Website</span>
                    </label>
                    <p class="text-xs text-gray-500 mt-1 ml-7">Tampilkan iframe preview (bisa membuat lambat)</p>
                </div>
            </div>

            <!-- Kolom Kanan - Stats -->
            <div class="space-y-4">
                <div class="bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-4">ğŸ“Š Statistics</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span>Total Visitor:</span>
                            <span class="font-bold" id="statTotal">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Sedang Proses:</span>
                            <span class="font-bold text-yellow-300" id="statPending">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Berhasil:</span>
                            <span class="font-bold text-green-300" id="statSuccess">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Gagal:</span>
                            <span class="font-bold text-red-300" id="statFailed">0</span>
                        </div>
                        <div class="mt-4 pt-4 border-t border-white/20">
                            <div class="flex justify-between mb-2">
                                <span>Progress:</span>
                                <span class="font-bold" id="statProgress">0%</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-3">
                                <div id="progressBar" class="bg-white h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Status -->
                <div id="statusBox" class="bg-purple-50 border-2 border-purple-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-semibold text-purple-800">Status:</span>
                        <span id="statusText" class="text-purple-600 font-semibold">Siap Memulai</span>
                    </div>
                    <div class="text-sm text-gray-600">
                        <div>â±ï¸ Waktu Mulai: <span id="startTime">-</span></div>
                        <div>âŒ› Estimasi Selesai: <span id="estimateTime">-</span></div>
                    </div>
                </div>

                <!-- Tombol Kontrol -->
                <div class="flex gap-4">
                    <button 
                        id="startBtn"
                        class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-semibold py-3 px-6 rounded-lg transition transform hover:scale-105 active:scale-95 shadow-lg"
                    >
                        ğŸš€ Mulai Simulasi
                    </button>
                    <button 
                        id="stopBtn"
                        class="flex-1 bg-red-500 hover:bg-red-600 text-white font-semibold py-3 px-6 rounded-lg transition transform hover:scale-105 active:scale-95 opacity-50 cursor-not-allowed shadow-lg"
                        disabled
                    >
                        â¹ï¸ Stop
                    </button>
                </div>
            </div>
        </div>

        <!-- Log Area -->
        <div>
            <div class="flex justify-between items-center mb-2">
                <label class="text-sm font-semibold text-gray-700">ğŸ“ Log Aktivitas Real-time</label>
                <div class="flex gap-2">
                    <label class="flex items-center space-x-1 text-xs">
                        <input type="checkbox" id="autoScroll" class="w-4 h-4" checked>
                        <span class="text-gray-600">Auto Scroll</span>
                    </label>
                    <button id="clearLogBtn" class="text-xs text-red-500 hover:text-red-700 font-semibold">Clear Log</button>
                </div>
            </div>
            <div id="logArea" class="bg-gray-900 text-green-400 p-4 rounded-lg h-96 overflow-y-auto font-mono text-sm">
                <div class="text-gray-500">Menunggu simulasi dimulai...</div>
            </div>
        </div>

        <!-- Preview Area (Optional) -->
        <div id="previewContainer" class="mt-6 hidden">
            <label class="block text-sm font-semibold text-gray-700 mb-2">ğŸ‘ï¸ Live Preview Website</label>
            <iframe 
                id="previewFrame" 
                class="w-full h-96 border-2 border-purple-300 rounded-lg"
                sandbox="allow-scripts allow-same-origin"
            ></iframe>
        </div>
    </div>

    <script>
        let isRunning = false;
        let stats = { total: 0, pending: 0, success: 0, failed: 0 };
        let startTimestamp = null;

        // User Agents berbeda untuk simulasi
        const userAgents = [
            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/120.0.0.0 Safari/537.36',
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 Safari/537.36',
            'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0',
            'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 Chrome/120.0.0.0 Safari/537.36',
            'Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 Safari/604.1',
            'Mozilla/5.0 (iPad; CPU OS 17_0 like Mac OS X) AppleWebKit/605.1.15 Safari/604.1',
            'Mozilla/5.0 (Android 14; Mobile) AppleWebKit/537.36 Chrome/120.0.0.0 Safari/537.36',
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 Safari/605.1.15',
        ];

        const devices = [
            'ğŸ’» Windows PC', 'ğŸ–¥ï¸ MacBook', 'ğŸ¦Š Firefox PC', 'ğŸ§ Linux PC',
            'ğŸ“± iPhone', 'ğŸ“± iPad', 'ğŸ¤– Android Phone', 'ğŸ§­ Safari Mac'
        ];

        const locations = [
            'ğŸ‡®ğŸ‡© Jakarta', 'ğŸ‡®ğŸ‡© Surabaya', 'ğŸ‡®ğŸ‡© Bandung', 'ğŸ‡®ğŸ‡© Medan', 'ğŸ‡®ğŸ‡© Semarang',
            'ğŸ‡®ğŸ‡© Makassar', 'ğŸ‡®ğŸ‡© Palembang', 'ğŸ‡®ğŸ‡© Denpasar', 'ğŸ‡®ğŸ‡© Yogyakarta', 'ğŸ‡®ğŸ‡© Malang'
        ];

        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('id-ID', { hour12: false });
            const logEntry = document.createElement('div');
            
            let color = 'text-blue-400';
            if (type === 'success') color = 'text-green-400';
            if (type === 'error') color = 'text-red-400';
            if (type === 'warning') color = 'text-yellow-400';
            
            logEntry.innerHTML = `<span class="text-gray-500">[${timestamp}]</span> <span class="${color}">${message}</span>`;
            
            const logArea = document.getElementById('logArea');
            if (logArea.querySelector('.text-gray-500:only-child')) {
                logArea.innerHTML = '';
            }
            
            logArea.appendChild(logEntry);
            
            if (document.getElementById('autoScroll').checked) {
                logArea.scrollTop = logArea.scrollHeight;
            }
        }

        function updateStats() {
            document.getElementById('statTotal').textContent = stats.total;
            document.getElementById('statPending').textContent = stats.pending;
            document.getElementById('statSuccess').textContent = stats.success;
            document.getElementById('statFailed').textContent = stats.failed;
            
            const completed = stats.success + stats.failed;
            const progress = stats.total > 0 ? Math.round(completed / stats.total * 100) : 0;
            document.getElementById('statProgress').textContent = progress + '%';
            document.getElementById('progressBar').style.width = progress + '%';
        }

        async function simulateVisit(visitorId, url, delay, isFirst = false) {
            if (!isRunning) return;

            // Wait for delay
            if (!isFirst) {
                await new Promise(resolve => setTimeout(resolve, delay));
            }

            if (!isRunning) return;

            stats.pending++;
            updateStats();

            const deviceIndex = Math.floor(Math.random() * devices.length);
            const device = devices[deviceIndex];
            const location = locations[Math.floor(Math.random() * locations.length)];
            const userAgent = document.getElementById('randomUA').checked 
                ? userAgents[deviceIndex] 
                : userAgents[0];

            addLog(`ğŸ‘¤ Visitor #${visitorId} ${device} dari ${location} sedang mengakses...`, 'info');

            // Simulasi request dengan iframe tersembunyi
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.sandbox = 'allow-scripts allow-same-origin';
            iframe.src = url + '?visitor=' + visitorId + '&t=' + Date.now();
            document.body.appendChild(iframe);

            // Simulasi loading time
            const loadingTime = 1000 + Math.random() * 2000;
            await new Promise(resolve => setTimeout(resolve, loadingTime));

            // Remove iframe
            document.body.removeChild(iframe);

            if (!isRunning) return;

            stats.pending--;

            // Random success/fail (98% success rate)
            const isSuccess = Math.random() > 0.02;
            
            if (isSuccess) {
                stats.success++;
                addLog(`âœ… Visitor #${visitorId} berhasil mengakses (${Math.round(loadingTime)}ms)`, 'success');
            } else {
                stats.failed++;
                addLog(`âŒ Visitor #${visitorId} gagal mengakses (timeout)`, 'error');
            }
            
            updateStats();
        }

        async function startSimulation() {
            const url = document.getElementById('urlInput').value.trim();
            const visitorCount = parseInt(document.getElementById('visitorCount').value);
            const interval = parseFloat(document.getElementById('intervalInput').value) * 1000;
            const randomDelay = document.getElementById('randomDelay').checked;

            if (!url || !visitorCount || !interval) {
                alert('Mohon isi semua field dengan benar!');
                return;
            }

            isRunning = true;
            stats = { total: visitorCount, pending: 0, success: 0, failed: 0 };
            startTimestamp = new Date();

            // Disable inputs
            document.getElementById('urlInput').disabled = true;
            document.getElementById('visitorCount').disabled = true;
            document.getElementById('intervalInput').disabled = true;
            document.getElementById('randomDelay').disabled = true;
            document.getElementById('randomUA').disabled = true;
            document.getElementById('showPreview').disabled = true;
            document.getElementById('startBtn').disabled = true;
            document.getElementById('startBtn').classList.add('opacity-50', 'cursor-not-allowed');
            document.getElementById('stopBtn').disabled = false;
            document.getElementById('stopBtn').classList.remove('opacity-50', 'cursor-not-allowed');

            document.getElementById('statusText').textContent = 'ğŸŸ¢ Running...';
            document.getElementById('startTime').textContent = startTimestamp.toLocaleTimeString('id-ID');
            
            // Calculate estimate
            const totalTime = (visitorCount * interval) / 1000;
            const estimateEnd = new Date(startTimestamp.getTime() + totalTime * 1000);
            document.getElementById('estimateTime').textContent = estimateEnd.toLocaleTimeString('id-ID');

            addLog(`ğŸš€ Memulai simulasi ${visitorCount} visitor...`, 'info');
            addLog(`ğŸŒ Target: ${url}`, 'info');
            addLog(`â±ï¸  Interval: ${interval/1000}s ${randomDelay ? '+ random delay' : ''}`, 'info');
            addLog(`ğŸ“Š Estimasi selesai: ${Math.round(totalTime)}s`, 'warning');

            updateStats();

            // Show preview if enabled
            if (document.getElementById('showPreview').checked) {
                document.getElementById('previewContainer').classList.remove('hidden');
                document.getElementById('previewFrame').src = url;
            }

            // Start all visitors
            const promises = [];
            for (let i = 1; i <= visitorCount; i++) {
                let delay = interval * (i - 1);
                if (randomDelay && i > 1) {
                    delay += Math.random() * 2000; // Random 0-2s
                }
                promises.push(simulateVisit(i, url, delay, i === 1));
            }

            // Wait for all to complete
            await Promise.all(promises);

            if (isRunning) {
                stopSimulation(true);
            }
        }

        function stopSimulation(completed = false) {
            isRunning = false;

            document.getElementById('urlInput').disabled = false;
            document.getElementById('visitorCount').disabled = false;
            document.getElementById('intervalInput').disabled = false;
            document.getElementById('randomDelay').disabled = false;
            document.getElementById('randomUA').disabled = false;
            document.getElementById('showPreview').disabled = false;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('startBtn').classList.remove('opacity-50', 'cursor-not-allowed');
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('stopBtn').classList.add('opacity-50', 'cursor-not-allowed');

            const duration = startTimestamp ? Math.round((new Date() - startTimestamp) / 1000) : 0;

            if (completed) {
                document.getElementById('statusText').textContent = 'âœ… Selesai';
                addLog(`ğŸ‰ Simulasi selesai dalam ${duration}s! Success: ${stats.success}, Failed: ${stats.failed}`, 'success');
            } else {
                document.getElementById('statusText').textContent = 'â¸ï¸ Dihentikan';
                addLog(`â¸ï¸ Simulasi dihentikan setelah ${duration}s oleh user`, 'warning');
            }
        }

        document.getElementById('startBtn').addEventListener('click', startSimulation);
        document.getElementById('stopBtn').addEventListener('click', () => stopSimulation(false));
        document.getElementById('clearLogBtn').addEventListener('click', () => {
            document.getElementById('logArea').innerHTML = '<div class="text-gray-500">Log dibersihkan...</div>';
        });

        // Toggle preview
        document.getElementById('showPreview').addEventListener('change', (e) => {
            if (!e.target.checked) {
                document.getElementById('previewContainer').classList.add('hidden');
            }
        });
    </script>
</body>
</html>